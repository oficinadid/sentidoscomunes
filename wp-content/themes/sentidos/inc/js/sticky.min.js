/**
 * @name jQuery Stick 'em
 * @author Trevor Davis
 * @version 1.4
 *
 *	$('.container').stickem({
 *	 	item: '.stickem',
 *		container: '.stickem-container',
 *		stickClass: 'stickit',
 *		endStickClass: 'stickit-end',
 *		offset: 0,
 *		onStick: null,
 *		onUnstick: null
 *	});
 */(function(e,t,n,r){var i=function(n,r){this.elem=n;this.$elem=e(n);this.options=r;this.metadata=this.$elem.data("stickem-options");this.$win=e(t)};i.prototype={defaults:{item:".stickem",container:".stickem-container",stickClass:"stickit",endStickClass:"stickit-end",offset:0,start:0,onStick:null,onUnstick:null},init:function(){var t=this;t.config=e.extend({},t.defaults,t.options,t.metadata);t.setWindowHeight();t.getItems();t.bindEvents();return t},bindEvents:function(){var t=this;t.$win.on("scroll.stickem",e.proxy(t.handleScroll,t));t.$win.on("resize.stickem",e.proxy(t.handleResize,t))},destroy:function(){var e=this;e.$win.off("scroll.stickem");e.$win.off("resize.stickem")},getItem:function(t,n){var r=this,i=e(n),s={$elem:i,elemHeight:i.height(),$container:i.parents(r.config.container),isStuck:!1};if(r.windowHeight>s.elemHeight){s.containerHeight=s.$container.outerHeight();s.containerInner={border:{bottom:parseInt(s.$container.css("border-bottom"),10)||0,top:parseInt(s.$container.css("border-top"),10)||0},padding:{bottom:parseInt(s.$container.css("padding-bottom"),10)||0,top:parseInt(s.$container.css("padding-top"),10)||0}};s.containerInnerHeight=s.$container.height();s.containerStart=s.$container.offset().top-r.config.offset+r.config.start+s.containerInner.padding.top+s.containerInner.border.top;s.scrollFinish=s.containerStart-r.config.start+(s.containerInnerHeight-s.elemHeight);s.containerInnerHeight>s.elemHeight&&r.items.push(s)}else s.$elem.removeClass(r.config.stickClass+" "+r.config.endStickClass)},getItems:function(){var t=this;t.items=[];t.$elem.find(t.config.item).each(e.proxy(t.getItem,t))},handleResize:function(){var e=this;e.getItems();e.setWindowHeight()},handleScroll:function(){var e=this;if(e.items.length>0){var t=e.$win.scrollTop();for(var n=0,r=e.items.length;n<r;n++){var i=e.items[n];if(i.isStuck&&(t<i.containerStart||t>i.scrollFinish)){i.$elem.removeClass(e.config.stickClass);t>i.scrollFinish&&i.$elem.addClass(e.config.endStickClass);i.isStuck=!1;e.config.onUnstick&&e.config.onUnstick(i)}else if(i.isStuck===!1&&t>i.containerStart&&t<i.scrollFinish){i.$elem.removeClass(e.config.endStickClass).addClass(e.config.stickClass);i.isStuck=!0;e.config.onStick&&e.config.onStick(i)}}}},setWindowHeight:function(){var e=this;e.windowHeight=e.$win.height()-e.config.offset}};i.defaults=i.prototype.defaults;e.fn.stickem=function(e){this.destroy=function(){this.each(function(){(new i(this,e)).destroy()})};return this.each(function(){(new i(this,e)).init()})}})(jQuery,window,document);